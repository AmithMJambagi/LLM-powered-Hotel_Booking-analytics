# Booking Analytics and Q&A System

This project is a comprehensive solution for analyzing hotel booking data and providing intelligent question-answering capabilities using state-of-the-art machine learning models. It integrates a vector database, embedding models, and a large language model (LLM) to enable advanced analytics and natural language querying.

---

## Features

- **Data Analytics**: Analyze booking data to extract insights such as revenue trends, cancellation rates, and popular hotels.
- **Question Answering (Q&A)**: Use a Retrieval-Augmented Generation (RAG) pipeline to answer user queries based on booking data.
- **API Integration**: Expose analytics and Q&A functionalities via a FastAPI-based RESTful API.
- **Visualization**: Generate visual insights such as revenue trends and geographical booking distributions.
- **Database Management**: Efficiently manage booking data using SQLite and ChromaDB for vector-based search.

---

## Project Structure

```
project/
├── analytics.py          # Data visualization and analytics functions
├── app.py                # FastAPI application for analytics and Q&A
├── dbconverter.py        # Script to convert CSV data into SQLite database
├── rag_qa.py             # Retrieval-Augmented Generation (RAG) pipeline
├── rag_qa copy.py        # Alternate implementation of RAG pipeline
├── processed_data.csv    # Sample processed booking data (not included in repo)
├── bookings.db           # SQLite database file (generated by dbconverter.py)
└── README.md             # Project documentation
```

---

## Setup Instructions

### Prerequisites

1. **Python 3.8+**: Ensure Python is installed on your system.
2. **Dependencies**: Install the required Python packages using `pip`.
3. **Hugging Face Account**: Obtain an API token from [Hugging Face](https://huggingface.co/).

### Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/your-repo/booking-analytics.git
   cd booking-analytics
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

3. Set up the SQLite database:
   - Place your processed CSV file in the project directory.
   - Run `dbconverter.py` to populate the database:
     ```bash
     python dbconverter.py
     ```

4. Authenticate with Hugging Face:
   - Replace the placeholder token in the code with your Hugging Face API token.

5. Initialize ChromaDB:
   - Ensure the `./chroma_db` directory exists for persistent storage.

---

## Usage

### Running the API

Start the FastAPI server:
```bash
uvicorn app:app --reload
```

Access the API documentation at `http://127.0.0.1:8000/docs`.

### Example Endpoints

1. **Health Check**:
   - Endpoint: `/health`
   - Description: Verify the health of the database, ChromaDB, embedding model, and Hugging Face API.

2. **Analytics**:
   - Endpoint: `/analytics`
   - Method: `POST`
   - Payload:
     ```json
     {
       "month": 7,
       "year": 2017
     }
     ```
   - Response: Returns analytics such as total revenue, average booking price, and cancellation rate.

3. **Ask a Question**:
   - Endpoint: `/ask`
   - Method: `POST`
   - Payload:
     ```json
     {
       "question": "What is the total revenue in July 2017?"
     }
     ```
   - Response: Provides an answer based on the booking data.

### Running Analytics Scripts

Run `analytics.py` to generate visualizations:
```bash
python analytics.py
```

---

## Key Components

### 1. **Database Management**
- **SQLite**: Stores booking data in a relational database.
- **ChromaDB**: Provides vector-based search capabilities for efficient retrieval.

### 2. **Machine Learning Models**
- **SentenceTransformer**: Encodes text into embeddings for vector search.
- **Hugging Face Models**: Generates answers to user queries using LLMs.

### 3. **FastAPI**
- Exposes RESTful endpoints for analytics and Q&A functionalities.

### 4. **Visualization**
- Uses `matplotlib` and `seaborn` to create insightful visualizations.

---

## Example Workflow

1. **Data Preparation**:
   - Convert raw booking data into a structured SQLite database using `dbconverter.py`.

2. **Data Indexing**:
   - Index booking data into ChromaDB for vector-based search.

3. **Analytics**:
   - Use `analytics.py` or the `/analytics` API endpoint to extract insights.

4. **Q&A**:
   - Use the `/ask` API endpoint to query the system with natural language questions.

---

## Notes

- Ensure the Hugging Face API token is kept secure and not exposed in public repositories.
- The `processed_data.csv` file is not included in the repository. Replace it with your own data.
- For large datasets, consider optimizing database queries and vector indexing.

---

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.

---

## Contact

For questions or support, please contact [your-email@example.com].
